import{a as s,b as M,e as P,W as _,j as e,m,L as S,P as T,r as F,i as H,n as I,I as W,f as A}from"./vendor-446e3497.js";import{u as b}from"./react-intersection-observer-ba847fea.js";import{a as E,p as R,G as J,M as L,i as w,b as D,Q as N,c as K,u as X,N as Y}from"./common-c2210d67.js";import{f as Z,d as ee}from"./shared/CategoryMoviesPage/movieDetailsPage-7b8afc0d.js";const $=({category:o})=>{const[i,u]=s.useState([]),[a,h]=s.useState(0),d=M(),{ref:y,inView:f}=b({threshold:.1}),{data:x,error:v,fetchNextPage:g,isLoading:p,isError:n,isSuccess:c}=P(["topRatedMovies",{category:o}],K,{staleTime:6e4,cacheTime:6e4,getNextPageParam:r=>{if(!(typeof r=="object"&&r.nextPage>r.totalPages))return r.nextPage}});return s.useEffect(()=>{window.scrollTo({top:0})},[]),s.useEffect(()=>{i.length!==0&&f&&g()},[f]),s.useEffect(()=>{c&&(u([...i,...x.pages[a].results]),h(a+1)),n&&_.error(`Error: ${v.response.data.message}`)},[x,n,c]),p?e.jsx(E,{}):e.jsxs(e.Fragment,{children:[e.jsxs(m.div,{initial:"closed",animate:"open",exit:"exit",variants:R,children:[e.jsx(J,{path:"/"}),i.length>0&&e.jsx(L,{children:i.map(r=>e.jsx(m.li,{initial:"closed",animate:"open",exit:"exit",variants:w(),children:e.jsx(S,{to:`/movies/${r.id}`,state:{from:{location:d}},children:e.jsx(D,{movie:r})})},r.id))})]}),e.jsx(N,{ref:y})]})};$.propTypes={category:T.string.isRequired};const te=$,xe=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));var j={},se=H;Object.defineProperty(j,"__esModule",{value:!0});var C=j.default=void 0,ie=se(F()),re=e,oe=(0,ie.default)((0,re.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");C=j.default=oe;const ae=I(m.li)`
  position: relative;
`,ne=I(W)`
  position: absolute;
  top: 0;
  right: 0;
  z-index: 2;
  color: ${({theme:o})=>o.bgElementColor};
  width: 50px;
  height: 50px;

  & > svg {
    width: 30px;
    height: 30px;
  }
`,V=({category:o})=>{const[i,u]=s.useState([]),[a,h]=s.useState(0),[d]=X("userID"),f=s.useRef(10).current,x=M(),{ref:v,inView:g}=b({threshold:.1}),{data:p,isError:n,isSuccess:c,isLoading:r,error:B,fetchNextPage:O}=P(["getMovies",{userID:d,limit:f,category:o}],Z,{enabled:!0,staleTime:6e4,cacheTime:0,getNextPageParam:({movies:t,nextPage:l})=>{if(t&&!(t.length<10))return l}}),q=()=>A(t=>ee(t)),{mutate:z}=q();s.useEffect(()=>{window.scrollTo({top:0})},[]),s.useEffect(()=>{i.length!==0&&g&&O()},[g]),s.useEffect(()=>{c&&(u([...i,...p.pages[a].movies]),h(a+1)),n&&_.error(`Error: ${B.response.data.message}`)},[p,n,c]);const k=(t,l)=>{t.currentTarget.nodeName==="BUTTON"&&z([d,l],{onSuccess:({data:G})=>{const Q=i.filter(({_id:U})=>U!==G.id);u([...Q])}})};return r?e.jsx(E,{}):e.jsxs(e.Fragment,{children:[e.jsx(m.div,{initial:"closed",animate:"open",exit:"exit",variants:R,children:i.length>0?e.jsx(L,{children:i.map(t=>e.jsxs(ae,{initial:"closed",animate:"open",exit:"exit",variants:w(),children:[e.jsx(ne,{onClick:l=>k(l,t._id),children:e.jsx(C,{})}),e.jsx(S,{to:`/movies/${t.idbID}`,state:{from:{location:x.pathname}},children:e.jsx(D,{movie:t})})]},t._id))}):e.jsx(Y,{children:e.jsx("h2",{style:{textTransform:"uppercase"},children:"List is empty"})})}),e.jsx(N,{ref:v})]})};V.propTypes={category:T.string.isRequired};const ce=V,ge=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"}));export{ge as a,xe as i};
