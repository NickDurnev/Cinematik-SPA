{"version":3,"file":"static/js/movieDetailsPage.1c98b840.chunk.js","mappings":"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","sources":["components/MovieInfo/MovieInfo.jsx","components/Modal/Modal.styled.jsx","components/Modal/Modal.jsx","pages/MovieDetailsPage/MovieDetailsPage.styled.jsx","pages/MovieDetailsPage/MovieDetailsPage.jsx"],"sourcesContent":["import PropTypes from 'prop-types';\nimport { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { useParams, useLocation } from 'react-router-dom';\nimport GoBackButton from '../GoBackButton/GoBackButton';\nimport {\n  InfoWrap,\n  Container,\n  MainInfo,\n  MovieGenresList,\n  AddInfo,\n  StyledLink,\n  LinkWrap,\n  Button,\n} from './MovieInfo.styled';\nimport imageNotFound from '../../images/Error 404 Wallpaper.jpg';\n\nconst Movieinfo = ({ movieData, handleModalToggle }) => {\n  const [prevLocationState, setPrevLocationState] = useState(null);\n  const location = useLocation();\n  const { movieId } = useParams();\n\n  useEffect(() => {\n    setPrevLocationState(location.state);\n  }, [location.state]);\n\n  console.log(movieData);\n\n  const {\n    poster_path,\n    release_date,\n    title,\n    tagline,\n    runtime,\n    overview,\n    budget,\n    genres,\n  } = movieData;\n  return (\n    <div>\n      <GoBackButton\n        path={\n          prevLocationState?.from?.location ??\n          prevLocationState?.from?.prevLocation ??\n          '/'\n        }\n        state={{\n          from: {\n            location,\n          },\n        }}\n      />\n      <Container>\n        <div>\n          <img\n            src={\n              poster_path !== null\n                ? `https://image.tmdb.org/t/p/w500${poster_path}`\n                : imageNotFound\n            }\n            alt={title}\n          />\n        </div>\n        <InfoWrap>\n          <h1>{title}</h1>\n          {tagline !== '' && <h2>\"{tagline}\"</h2>}\n          <p>{overview}</p>\n          <MainInfo>\n            <li>\n              <p>Release date:</p>\n              <p>Runtime:</p>\n              {budget !== 0 && <p>Budget:</p>}\n            </li>\n            <li>\n              <p> {release_date}</p>\n              <p>{runtime} minutes </p>\n              {budget !== 0 && <p>{budget} $</p>}\n            </li>\n          </MainInfo>\n          <MovieGenresList>\n            {genres.map(({ id, name }) => (\n              <li key={id}>\n                <Link\n                  to={`/movies/by_genre=${id}`}\n                  state={{\n                    from: {\n                      location,\n                    },\n                  }}\n                >\n                  {name}\n                </Link>\n              </li>\n            ))}\n          </MovieGenresList>\n          <Button type=\"button\" padding=\"10px\" onClick={handleModalToggle}>\n            Watch Trailer\n          </Button>\n          <AddInfo>\n            <LinkWrap>\n              <StyledLink\n                to={`/movies/${movieId}/cast`}\n                state={{\n                  ...prevLocationState,\n                }}\n              >\n                Cast\n              </StyledLink>\n              <StyledLink\n                to={`/movies/${movieId}/reviews`}\n                state={{\n                  ...prevLocationState,\n                }}\n              >\n                Reviews\n              </StyledLink>\n              <StyledLink\n                to={`/movies/${movieId}/similar_movies`}\n                state={{\n                  ...prevLocationState,\n                }}\n              >\n                Similar Movies\n              </StyledLink>\n            </LinkWrap>\n          </AddInfo>\n        </InfoWrap>\n      </Container>\n    </div>\n  );\n};\n\nMovieinfo.propTypes = {\n  movieData: PropTypes.shape({\n    poster_path: PropTypes.string,\n    release_date: PropTypes.string.isRequired,\n    title: PropTypes.string.isRequired,\n    tagline: PropTypes.string.isRequired,\n    runtime: PropTypes.number.isRequired,\n    budget: PropTypes.number,\n    genres: PropTypes.arrayOf(PropTypes.object),\n  }).isRequired,\n  handleModalToggle: PropTypes.func.isRequired,\n};\n\nexport default Movieinfo;\n","import styled from '@emotion/styled';\n\nexport const Backdrop = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: ${props => props.theme.backdropColor};\n  color: ${props => props.theme.textColor};\n  overflow-y: scroll;\n`;\n\nexport const StyledModal = styled.div`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  min-width: 300px;\n  text-align: center;\n  background-color: ${props => props.theme.modalBgColor};\n  font-weight: ${props => props.theme.mainTextFontWeight};\n`;\n","import PropTypes from 'prop-types';\nimport { createPortal } from 'react-dom';\nimport { StyledModal, Backdrop } from './Modal.styled';\n\nconst modalRoot = document.querySelector('#modal-root');\n\nconst Modal = ({ children, onModal }) => {\n  const onClickClose = e => {\n    if (e.target.nodeName === 'DIV') {\n      onModal(false);\n    }\n  };\n\n  return createPortal(\n    <Backdrop onClick={onClickClose}>\n      <StyledModal>{children}</StyledModal>\n    </Backdrop>,\n    modalRoot\n  );\n};\n\nModal.propTypes = {\n  children: PropTypes.node.isRequired,\n  onModal: PropTypes.func.isRequired,\n};\n\nexport default Modal;\n","import styled from '@emotion/styled';\nexport const Container = styled.div`\n  width: 95vw;\n  padding: 10px 5px;\n`;\n","import { useState, useRef, useEffect } from 'react';\nimport { useParams, Outlet, useNavigate } from 'react-router-dom';\nimport { useQuery } from 'react-query';\nimport { toast } from 'react-toastify';\nimport ThreeDots from 'components/Loaders/Loader';\nimport { movieDetails } from 'services/moviesApi';\nimport MovieInfo from 'components/MovieInfo';\nimport Modal from 'components/Modal/Modal';\nimport { fetchMovieTrailers } from '../../services/moviesApi';\nimport { Container } from './MovieDetailsPage.styled';\n\nconst MovieDetailsPage = () => {\n  const { movieId } = useParams();\n  let navigate = useNavigate();\n  const youtubeURL = useRef('https://www.youtube.com/embed/');\n  const [isModalOpen, setisModalOpen] = useState(false);\n  const [movieTrailer, setMovieTrailer] = useState(null);\n\n  const handleModalToggle = async bool => {\n    if (!bool) {\n      setisModalOpen(false);\n      return;\n    }\n    setisModalOpen(true);\n    if (!movieTrailer) {\n      const trailer = await addMovieTrailer();\n      sessionStorage.setItem('trailer', JSON.stringify(trailer));\n      setMovieTrailer(trailer);\n    }\n  };\n\n  const addMovieTrailer = async () => {\n    const trailers = await fetchMovieTrailers(movieId);\n    const officicalTrailer = trailers.find(({ name }) =>\n      name.includes('Official')\n    );\n    return officicalTrailer;\n  };\n\n  const { data, error, isLoading, isError, isSuccess } = useQuery(\n    ['movieDetails', { movieId }],\n    movieDetails,\n    { staleTime: 60000, cacheTime: 60000 }\n  );\n\n  useEffect(() => {\n    if (data === 404) {\n      const prevMovieId = localStorage.getItem('movieId');\n      navigate(`/movies/${prevMovieId}`);\n    }\n  }, [data, navigate]);\n\n  if (isLoading) {\n    return <ThreeDots />;\n  }\n\n  if (isError) {\n    return toast.error(`Ошибка: ${error.message}`);\n  }\n\n  if (isSuccess && data !== 404) {\n    localStorage.setItem('movieId', JSON.stringify(+movieId));\n    return (\n      <Container>\n        <MovieInfo\n          movieData={data}\n          handleModalToggle={bool => handleModalToggle(bool)}\n        />\n        {isModalOpen && (\n          <Modal onModal={bool => handleModalToggle(bool)}>\n            {movieTrailer ? (\n              <iframe\n                src={`${youtubeURL.current}${movieTrailer.key}?autoplay=0&mute=0&controls=1`}\n                title=\"video\"\n                width=\"600\"\n                height=\"400\"\n                allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n                allowFullScreen\n              ></iframe>\n            ) : (\n              <h2>We don't have trailer for this movie</h2>\n            )}\n          </Modal>\n        )}\n        <Outlet />\n      </Container>\n    );\n  }\n};\n\nexport default MovieDetailsPage;\n"],"names":["movieData","handleModalToggle","useState","prevLocationState","setPrevLocationState","location","useLocation","movieId","useParams","useEffect","state","console","log","poster_path","release_date","title","tagline","runtime","overview","budget","genres","GoBackButton","path","from","prevLocation","src","imageNotFound","alt","map","id","name","to","type","padding","onClick","Backdrop","styled","props","theme","backdropColor","textColor","StyledModal","modalBgColor","mainTextFontWeight","modalRoot","document","querySelector","children","onModal","createPortal","e","target","nodeName","Container","navigate","useNavigate","youtubeURL","useRef","isModalOpen","setisModalOpen","movieTrailer","setMovieTrailer","bool","addMovieTrailer","trailer","sessionStorage","setItem","JSON","stringify","fetchMovieTrailers","trailers","officicalTrailer","find","includes","useQuery","movieDetails","staleTime","cacheTime","data","error","isLoading","isError","isSuccess","prevMovieId","localStorage","getItem","toast","message","MovieInfo","current","key","width","height","allow","allowFullScreen"],"sourceRoot":""}