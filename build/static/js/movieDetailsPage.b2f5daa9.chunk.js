"use strict";(self.webpackChunkgoit_react_hw_05_movies=self.webpackChunkgoit_react_hw_05_movies||[]).push([[721],{8491:function(e,t,r){r.d(t,{Z:function(){return d}});var n,i=r(168),a=r(9958),c=r(6188),s=(0,a.Z)(c.E.div)(n||(n=(0,i.Z)(["\n  width: 100%;\n  border-radius: 5px;\n"]))),o=r(5905),u=r(184),d=function(e){var t=e.children,r=e.delay,n=void 0===r?0:r;return(0,u.jsx)(s,{initial:"closed",animate:"open",variants:(0,o.yr)(n),children:t})}},6930:function(e,t,r){r.r(t),r.d(t,{default:function(){return V}});var n,i=r(5861),a=r(885),c=r(4687),s=r.n(c),o=r(2791),u=r(6871),d=r(1933),l=r(6960),f=r(6188),p=r(2436),h=r(6580),v=r(2843),x=r(7477),m=r(1413),g=r(3504),j=r(354),y=r(273),w=r(2441),Z=r(4596),b=r(5615),k=r(3237),S=r(9436),E=r(184),I=function(e){var t,r,n,i,c=e.movieData,s=e.handleTrailerToggle,f=e.handleVerifyToggle,p=(0,o.useState)(null),h=(0,a.Z)(p,2),v=h[0],x=h[1],I=(0,o.useState)(null),_=(0,a.Z)(I,2),F=_[0],T=_[1],M=(0,o.useState)(!0),C=(0,a.Z)(M,2),O=C[0],A=C[1],D=(0,j.Z)("userID",null),V=(0,a.Z)(D,1)[0],W=(0,u.TH)(),U=(0,u.UO)().movieId,z=c.id,q=c.poster_path,J=c.release_date,K=c.vote_average,Q=c.title,R=c.tagline,B=c.runtime,L=c.overview,N=c.budget,P=c.genres,G={idbID:z,poster_path:q,title:Q,vote_average:K,genres:P,release_date:J,tagline:R,runtime:B,overview:L,budget:N},H=(0,d.useQuery)(["addFavoriteMovie",{userId:V,dataToFetch:G}],y.EV,{refetchOnWindowFocus:!1,enabled:!1}),$=(0,d.useQuery)(["addWatchedMovie",{userId:V,dataToFetch:G}],y.J8,{refetchOnWindowFocus:!1,enabled:!1}),X=(0,d.useQuery)(["checkFavoriteMovie",{userId:V,id:z}],y.Ad,{refetchOnWindowFocus:!1,enabled:O}),Y=(0,d.useMutation)((function(e){return(0,y.fx)(e)})).mutate,ee=function e(){var t;V?(e.refetch(),$.isSuccess&&T(!0),Y([V,null===(t=X.data)||void 0===t?void 0:t.id])):f(!0)};return(0,o.useEffect)((function(){x(W.state)}),[W.state]),(0,o.useEffect)((function(){var e;null!==(e=X.data)&&void 0!==e&&e.id&&(A(!1),T(!0),console.log(X.data))}),[X.data]),(0,o.useEffect)((function(){H.isSuccess&&T(!0),y.EV.isError&&l.Am.error("Error: ".concat(y.EV.error.response.data.message))}),[H.isSuccess,H.isError]),(0,o.useEffect)((function(){$.isError&&l.Am.error("Error: ".concat($.error.response.data.message))}),[$.isError]),(0,E.jsxs)(Z.EB,{children:[(0,E.jsx)(w.Z,{path:null!==(t=null!==(r=null===v||void 0===v||null===(n=v.from)||void 0===n?void 0:n.location)&&void 0!==r?r:null===v||void 0===v||null===(i=v.from)||void 0===i?void 0:i.prevLocation)&&void 0!==t?t:"/",state:{from:{location:W}}}),(0,E.jsxs)(Z.W2,{children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("img",{src:null!==q?"https://image.tmdb.org/t/p/w500".concat(q):S,alt:Q}),F?(0,E.jsxs)(Z.hU,{onClick:function(){return ee()},children:["Add to watched",(0,E.jsx)(b.r,{})]}):(0,E.jsxs)(Z.hU,{onClick:function(){V?H.refetch():f(!0)},children:["Add to favorites",(0,E.jsx)(k.r,{})]})]}),(0,E.jsxs)(Z.xD,{children:[(0,E.jsx)("h1",{children:Q}),""!==R&&(0,E.jsxs)("h2",{children:['"',R,'"']}),(0,E.jsx)("p",{children:L}),(0,E.jsxs)(Z.n4,{children:[(0,E.jsxs)("li",{children:[(0,E.jsx)("p",{children:"Release date:"}),(0,E.jsx)("p",{children:"Runtime:"}),0!==N&&(0,E.jsx)("p",{children:"Budget:"})]}),(0,E.jsxs)("li",{children:[(0,E.jsxs)("p",{children:[" ",J]}),(0,E.jsxs)("p",{children:[B," minutes "]}),0!==N&&(0,E.jsxs)("p",{children:[N," $"]})]})]}),(0,E.jsx)(Z.Ig,{children:P.map((function(e){var t=e.id,r=e.name;return(0,E.jsx)("li",{children:(0,E.jsx)(g.rU,{to:"/movies/by_genre=".concat(t),state:{from:{location:W}},children:r})},t)}))}),(0,E.jsx)(Z.zx,{type:"button",padding:"10px",onClick:s,children:"Watch Trailer"}),(0,E.jsx)(Z.Ff,{children:(0,E.jsxs)(Z.C5,{children:[(0,E.jsx)(Z.Fg,{to:"/movies/".concat(U,"/cast"),state:(0,m.Z)({},v),children:"Cast"}),(0,E.jsx)(Z.Fg,{to:"/movies/".concat(U,"/reviews"),state:(0,m.Z)({},v),children:"Reviews"}),(0,E.jsx)(Z.Fg,{to:"/movies/".concat(U,"/similar_movies"),state:(0,m.Z)({},v),children:"Similar Movies"})]})})]})]})]})},_=r(1153),F=r(4946),T=r(8491),M=r(168),C=r(9958),O=r(7608),A=C.Z.iframe(n||(n=(0,M.Z)(["\n  width: 360px;\n  height: 230px;\n  border: none;\n  border-radius: 5px;\n  background-color: inherit;\n\n  @media "," {\n    width: 600px;\n    height: 400px;\n  }\n"])),O.U.tablet),D=r(5905),V=function(){var e=(0,u.UO)().movieId,t=(0,u.s0)(),r=(0,o.useRef)("https://www.youtube.com/embed/"),n=(0,o.useState)(!1),c=(0,a.Z)(n,2),m=c[0],g=c[1],j=(0,o.useState)(!1),y=(0,a.Z)(j,2),w=y[0],Z=y[1],b=(0,o.useState)(null),k=(0,a.Z)(b,2),S=k[0],M=k[1],C=function(){var e=(0,i.Z)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return g(!1),e.abrupt("return");case 3:if(g(!0),S){e.next=10;break}return e.next=7,V();case 7:r=e.sent,sessionStorage.setItem("trailer",JSON.stringify(r)),M(r);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=(0,i.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return Z(!1),e.abrupt("return");case 3:Z(!0);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var t=(0,i.Z)(s().mark((function t(){var r,n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,x.np)(e);case 2:return r=t.sent,n=r.find((function(e){return e.name.includes("Official")})),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),W=(0,d.useQuery)(["movieDetails",{movieId:e}],x.hG,{staleTime:6e4,cacheTime:6e4}),U=W.data,z=W.error,q=W.isLoading,J=W.isError,K=W.isSuccess;return(0,o.useEffect)((function(){if(404===U){var e=localStorage.getItem("movieId");t("/movies/".concat(e))}}),[U,t]),q?(0,E.jsx)(v.Z,{}):J?l.Am.error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(z.message)):K&&404!==U?(localStorage.setItem("movieId",JSON.stringify(+e)),(0,E.jsxs)(f.E.div,{initial:"closed",animate:"open",exit:"exit",variants:D.yv,children:[(0,E.jsx)(I,{movieData:U,handleTrailerToggle:function(e){return C(e)},handleVerifyToggle:function(e){return O(e)}}),(0,E.jsxs)(p.M,{children:[m&&(0,E.jsxs)(_.Z,{onModal:function(e){return C(e)},children:[S&&(0,E.jsx)(A,{src:"".concat(r.current).concat(S.key,"?autoplay=0&mute=0&controls=1"),title:"video",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),!S&&(0,E.jsxs)(T.Z,{children:[(0,E.jsx)("h2",{children:"We don't have trailer for this movie"}),(0,E.jsx)(h.Z,{sx:{fontSize:70,mt:1}})]})]}),w&&(0,E.jsx)(_.Z,{onModal:function(e){return O(e)},padding:"30px",children:(0,E.jsx)(F.Z,{})})]}),(0,E.jsx)(u.j3,{})]})):void 0}},273:function(e,t,r){r.d(t,{Ad:function(){return h},EV:function(){return x},J8:function(){return g},fx:function(){return f},vw:function(){return d}});var n=r(885),i=r(5861),a=r(4687),c=r.n(a),s=r(4569),o=r.n(s),u="https://nodejs-cinematik-rest-api.onrender.com/";function d(e){return l.apply(this,arguments)}function l(){return(l=(0,i.Z)(c().mark((function e(t){var r,i,a,s,d,l,f,p,h,v,x;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.pageParam,i=void 0===r?1:r,a=t.queryKey,s=(0,n.Z)(a,2),s[0],d=s[1],l=d.userId,f=d.limit,p=d.category,e.next=4,o().get("".concat(u,"movies/").concat(l,"?page=").concat(i,"&limit=").concat(f,"&category=").concat(p));case 4:return h=e.sent,v=h.data,x=v.data.movies,e.abrupt("return",{movies:x,nextPage:i+1});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return p.apply(this,arguments)}function p(){return(p=(0,i.Z)(c().mark((function e(t){var r,i,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,n.Z)(t,2),i=r[0],a=r[1],e.next=3,o().delete("".concat(u,"movies/").concat(i,"/").concat(a));case 3:return s=e.sent,e.abrupt("return",null===s||void 0===s?void 0:s.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return(v=(0,i.Z)(c().mark((function e(t){var r,i,a,s,d,l,f;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.queryKey,i=(0,n.Z)(r,2),i[0],a=i[1],s=a.userId,d=a.id,e.next=4,o().get("".concat(u,"movies/favorites/").concat(s,"/").concat(d));case 4:return l=e.sent,f=l.data,e.abrupt("return",f);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return m.apply(this,arguments)}function m(){return(m=(0,i.Z)(c().mark((function e(t){var r,i,a,s,d,l,f;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.queryKey,i=(0,n.Z)(r,2),i[0],a=i[1],s=a.userId,d=a.dataToFetch,e.next=4,o().post("".concat(u,"movies/").concat(s,"?category=favorites"),d);case 4:return l=e.sent,f=l.data,e.abrupt("return",f);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return j.apply(this,arguments)}function j(){return(j=(0,i.Z)(c().mark((function e(t){var r,i,a,s,d,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.queryKey,i=(0,n.Z)(r,2),i[0],a=i[1],s=a.userId,d=a.dataToFetch,e.next=4,o().post("".concat(u,"movies/").concat(s,"?category=watched"),d);case 4:return l=e.sent,e.abrupt("return",l.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},6580:function(e,t,r){var n=r(4836);t.Z=void 0;var i=n(r(5649)),a=r(184),c=(0,i.default)([(0,a.jsx)("circle",{cx:"15.5",cy:"9.5",r:"1.5"},"0"),(0,a.jsx)("circle",{cx:"8.5",cy:"9.5",r:"1.5"},"1"),(0,a.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm0-6c-2.33 0-4.32 1.45-5.12 3.5h1.67c.69-1.19 1.97-2 3.45-2s2.75.81 3.45 2h1.67c-.8-2.05-2.79-3.5-5.12-3.5z"},"2")],"SentimentVeryDissatisfied");t.Z=c}}]);
//# sourceMappingURL=movieDetailsPage.b2f5daa9.chunk.js.map