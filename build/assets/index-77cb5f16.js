import{r as s,u as P,d as w,E as L,W as T,j as t,m as p,D as I}from"./vendor-373470ad.js";import{u as S,Q as V}from"./QueryTrigger-cd97c1b5.js";import{s as $}from"./moviesIDBService-2b8b2360.js";import{M as k}from"./MovieList-58811b45.js";import{M as y}from"./MovieCard-b3ef3283.js";import{G as N}from"./index-e389a3ba.js";import{p as Q,i as b}from"./animations-5f4924b3.js";import"./index-e2daedf6.js";import"./DefaultMovieImage-d6b5fbbf.js";const G=({query:o})=>{const[i,a]=s.useState([]),[n,c]=s.useState(0),g=P();let h=w();const{ref:v,inView:f}=S({threshold:.1}),{data:r,error:j,fetchNextPage:E,isLoading:m,isError:l,isSuccess:x,refetch:M}=L(["searchMovie",{query:o}],$,{enabled:!1,staleTime:6e4,cacheTime:6e4,getNextPageParam:e=>{if(e&&!(typeof e=="object"&&e.nextPage>e.totalPages))return e.nextPage}});return s.useEffect(()=>{window.scrollTo({top:0})},[]),s.useEffect(()=>{window.scrollTo({top:0}),a([]),c(0),M(),h(`?query=${o}`)},[o]),s.useEffect(()=>{i.length!==0&&f&&E()},[f]),s.useEffect(()=>{var e,u;if(x){const d=r==null?void 0:r.pages[n];d&&(a([...i,...d.results]),c(n+1))}l&&T.error(`Error: ${((u=(e=j.response)==null?void 0:e.data)==null?void 0:u.message)??"Unknown error"}`)},[r,l,x]),t.jsxs(t.Fragment,{children:[t.jsxs(p.div,{initial:"closed",animate:"open",exit:"exit",variants:Q,children:[m&&t.jsx(N,{}),i.length>0&&!m&&t.jsx(k,{children:i.map(e=>t.jsx(p.li,{initial:"closed",animate:"open",exit:"exit",variants:b(),children:t.jsx(I,{to:`/movies/${e.id}`,state:{from:{location:g}},children:t.jsx(y,{movie:e})})},e.id))})]}),t.jsx(V,{ref:v})]})},H=G;export{H as default};
